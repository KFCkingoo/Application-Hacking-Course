## h4 Some Disassembly Required 
Harjoitukset on tehty keväällä Teron ja Larin 2026 Sovellusten hakkerointi ja haavoittuvuudet - ICI012AS3A-3003 kurssia varten.

### x) Lue ja tiivistä
Videossa käydään läpi picoCTF bbbloat haastetta.

Ghidralla käänteistulkinta ja hakkerointi.

---

### a) Install Ghidra.
Asennettiin Java ja Ghidra.

```
sudo apt install openjdk-21-jdk
wget https://github.com/NationalSecurityAgency/ghidra/releases/download/Ghidra_12.0.2_build/ghidra_12.0.2_PUBLIC_20260129.zip
unzip ghidra_12.0.2_PUBLIC_20260129.zip
```


### b) rever-C. Reverse engineer the packd binary to C language with Ghidra. Find the main program. Give variables descriptive names. Explain the program's operation. Solve the task from the binary, without the original source code.
Importattiin packd tiedosto Ghidraan ja käänteistulkittiin se. Etsittiin sieltä pääohjelma. Voitiin päätellä näistä pääohjelma :

<img width="165" height="236" alt="kuva" src="https://github.com/user-attachments/assets/43be6cd7-5722-4c81-b837-92500ea2aa55" />

>_Erottuva funktio_

<img width="458" height="217" alt="kuva" src="https://github.com/user-attachments/assets/fa503c00-0a05-4dee-be7b-82bb28289d86" />
<img width="304" height="220" alt="kuva" src="https://github.com/user-attachments/assets/1e0343f5-6cbb-465b-9f5d-cd18eebc359e" />

>_Stringi mikä johtaa samaan funktioon_

Vaihdettiin pääfunktiolle nimi `main` ja muuttujalle `password`

<img width="315" height="271" alt="kuva" src="https://github.com/user-attachments/assets/b5c1550d-adf0-4405-bdd8-2058f5a342e1" />

Purettiin tiedosto UPX-ohjelmalla selkokieliseksi ja vietiin se Ghidraan. Aikaisemmat `main` ja `password` muutoksia ei tallennettu ennen käänteismallia...

<img width="576" height="274" alt="kuva" src="https://github.com/user-attachments/assets/8b27f4ba-3a40-4cea-8d51-204667428b9a" />

Ohjelman tarkoitus oli tehdä salasanakysely if-ehdolla. Ohjelman toiminnan syvempään ymmärrykseen ja selitykseen kuitenkin hyödynnettiin tekoälyä.

`int iVar1;` säilyttää salasanan.

`char local_28 [32];` käyttäjän syöte.

`__isoc99_scanf(&DAT_0010201d,local_28);` lukee syötteen puskuriin local_28. &DAT_0010201d on tekoälyn mukaan stringi "%s".

`iVar1 = strcmp(local_28, "piilos-AnAnAs");` Syötteen vertailu salasanaan.

if-else-ehdot tulostaa tekstit ehtojen mukaan.

Salasana tuli esiin käänteismallissa `piilos-AnAnAs` ja on sama salasana kuin edellisessä harjoituksessa.

<img width="696" height="57" alt="kuva" src="https://github.com/user-attachments/assets/8351ddc8-fae5-4590-ba31-b36dd4a9537b" />

---

### c) If backwards. Modify the passtr program's binary (without the original source code) so that it accepts all passwords except the correct one. Demonstrate with tests that the program works.








