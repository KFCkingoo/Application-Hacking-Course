## h3 No Strings Attached
Harjoitukset on tehty keväällä Teron ja Larin 2026 Sovellusten hakkerointi ja haavoittuvuudet - ICI012AS3A-3003 kurssia varten.

### a) Strings. Find the correct password using 'strings'. Also find the flag.
Käännettiin binääri tekstiksi `strings passtr`, sitten löydettiin salasana ja lippu:

````
sala-hakkeri-321
FLAG{Tero-d75ee66af0a68663f15539ec0f46e3b1}
````

Testattiin salasana:

<img width="500" height="100" alt="kuva" src="https://github.com/user-attachments/assets/07895f74-264a-4cdf-b822-6c5b83f59e4e" />

---
### b) Make a new version of the passtr.c program where the password doesn't appear directly as-is in the binary.
Aluksi yritettiin tehdä uusi muuttuja salasanalle, joka sitten lisättiin salasanan if-statement tilalle.

Testattiin strings ja tarkistettiin näkyykö salasana. Salasana oli vielä näkyvillä.
>_Myöhemmin selvisi, että oli unohdettu uudelleenkääntää ohjelmat GCC:llä. Ohjelma ei olisi toiminut oikein muutenkaan, koska koodia oli väärin tehty._

Yritettiin etsiä tietoa miten obfuskaatiota tehdään C kielelle, mutta tästä ei tullut hyödyksi tehtävälle. 
Ei ollut vinkkejä eikä osaaminen riittänyt obfuskaatioon, joten kysyttiin tekoälyltä neuvoa. 
Siinä tuli esille XOR-kryptaus ja se lisättiin ohjelmaan.

Koodiin lisättiin uusi merkkijono `char hidepw[]`, mikä tulostetaan oikean salasanan tilalle.

Luotiin XOR-avain `char key`, mitä käytettiin myöhemmin salasanan avaamiseen.

Lisättiin `for`-loop hyödyntäen XOR-avainta.

if-ehtoon vaihdettiin salasanan suoratekstin sijalle `hidepw` merkkijono.

<img width="541" height="226" alt="kuva" src="https://github.com/user-attachments/assets/562af288-48e5-42d2-8573-edff04bf5b02" />

>_Kuva koodista_

Uudelleenkäännettiin ohjelmat komennolla `gcc -o passtr passtr.c` ja ajettiin `strings passtr` käyntiin:

<img width="208" height="57" alt="kuva" src="https://github.com/user-attachments/assets/1d9f4321-9109-4995-babe-f71d18ae7c8f" />

>_Tekosalasana näkyvillä_

---

### c) Packd. Run 'packd' from the package ezbin-challenges.zip. What is the password? What is the flag? 
Ajettiin `strings packd` ja etsittiin salasana. Tulos näytti siltä, että ohjelma on enkryptattu.

Testattiin jos salasana piilos-An on oikein:

```
What's the password?
piilos-An
Sorry, no bonus.
```

Salanasana on väärin. Käytiin strings uudestaan läpi. 

Stringsissä luki, että tiedosto on pakattu UPX-paketoinnilla. Googlattiin mikä se on ja onko se turvallinen ohjelma.

Asennettiin uusin UPX Githubista:

```
wget https://github.com/upx/upx/releases/download/v5.1.0/upx-5.1.0-amd64_linux.tar.xz
tar -xf upx-5.1.0-amd64_linux.tar.xz
```

Ajettiin UPX-ohjelma ja siinä löytyi `-d` purkauskomento: `./upx-5.1.0-amd64_linux/upx -d h3/challenges/packd/packd`.

Testattiin strings uudestaan ja kryptatut tekstit aukesivat. Salasana on `piilos-AnAnAs`:

```
What's the password?
piilos-AnAnAs
Yes! That's the password. FLAG{Tero-0e3bed0a89d8851da933c64fefad4ff2}
```

Salasana oli oikein!

---







### Lähteet
Tehtävän b) XOR-enkryptauksessa on hyödynnetty ChatGPT-5.1: https://copilot.microsoft.com/

UPX-ohjelma Githubista. https://github.com/upx/upx/releases/tag/v5.1.0


