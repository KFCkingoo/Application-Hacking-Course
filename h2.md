## h2 Break & Unbreak
Tämä raportti on tehty keväällä Teron ja Larin 2026 Sovellusten hakkerointi ja haavoittuvuudet - ICI012AS3A-3003 kurssia varten.

### Environment
Debian 13 Trixie VM

Mozilla Firefox

Netti disabloitiin mikäli käytettiin fuzzing-työkaluja

### x)
#### A01:2021 – Broken Access Control
Pääsynhallinta soveltaa käytäntöjä siten, että käyttäjiltä estetään toimintoja heidän tarkoitettujen käyttöoikeuksien ulkopuolella.
Puutteet johtavat haavoittuvuuksiin.

Pääsynhallinta on tehokasta kun hyökkääjä ei voi muokata pääsynhallinnan tarkistusta tai metadataa kuten luotettavissa palvelinpuolenkoodeissa tai palvelittomissa API:ssa.

Toiminnalliset pääsynhallinnan yksiköt ja intergraatiotestit ovat kannattavia.

#### Find Hidden Web Directories - Fuzz URLs with ffuf
Fuff löytää web palvelimen salaiset hakemistot automaattisesti.

Fuffilla voi pörröttää (fuzzing) kaikkea muutakin tietoa kuten POST parametrit ja tunnisteet.

Testataan ilman nettiä estääkseen pakettivuotoja.

#### Access control vulnerabilities and privilege escalation
Puutteelliset pääsynhallinnat ovat yleisiä ja yleensä kriittisisesti haavoittuvaisia.

Pääsynhallinta on taipuvainen virheille ihmissuunnittelun myöntä.

#### Karvinen 2006: Report Writing
Raporting ohjeet

### a) Break into 010-staff-only
Ajettiin tehtävä ohjeiden mukaisesti ja avattiin se selaimella `http://127.0.0.1:5000`.

Yritetty saada salasana SQL injektiolla, mutta kysely sallii vain numeroita.

Avattiin Firefox Inspector ja etsittiing number input-kyselyä.

Vaihdettiin number tyyppi tyhjäksi ja kokeiltiin uutta arvoa value="`'OR 1=1--`"

Uusi arvo hyväksyttiin ja annettuun salasanaan tuli uusi tulos 'Your password is foo', mutta tämä ei ollut haettua tulosta.

Pyydetty tehtävä muistuttaa aikaisemmassa kurssissa tehtyä PortSwiggerin SQL Injection Labraharjoituksia, joten sieltä otettiin mallia UNION

Jatkettiin samalla tavalla salasanan kalastamista ja käyttämällä sivuston antamaa vinkkiä `SELECT password FROM pins WHERE pin='0';`.

Kokeiltiin uusi syöttö value="`'UNION SELECT password FROM pins--`":
<img width="1130" height="1020" alt="VirtualBox_DebianVM_22_01_2026_22_07_58" src="https://github.com/user-attachments/assets/569ed997-c657-4979-a3d8-60e496c25d00" />
Tulostui haluttu salasana.

### b) Fix the 010-staff-only vulnerability from source code. 

Huomattiin edellisestä tehtävästä, että haavoittuvuuden voidaan kalastaa SQL injektiolla.

Yritettiin korjata haavoittuvuus muuttamalla SQL kyselyn syöttöjä.

Katsottiin lähdekoodia ja todettiin, että tehtävän vinkit ja ratkaisut olivat tarpeen osaamiseeni.

Käytin tässä osiossa myös tekoälyä, jos olisi ollut myös muita ratkaisuja kiinnostuksen myötä.

SQL kyselyn haavoittuvuutta korjattiin vaihtamalla sql koodin pin syöttöä `pin=:pin;`.

Lisättiin uusi muuttuja seuraavaan riviin `safepin = {'pin': pin}`.

Lisättiin res rivin execute() funktion sisään safepin muuttuja `execute(text(sql), safepin)`.

<img width="542" height="151" alt="VirtualBox_DebianVM_22_01_2026_23_50_24" src="https://github.com/user-attachments/assets/eb58654e-83ee-4d29-a13e-ea531c65f7da" />






### Lähteet

OWASP: OWASP Top 10: A01 Broken Access Control

Karvinen 2023: Find Hidden Web Directories - Fuzz URLs with ffuf

PortSwigger: Access control vulnerabilities and privilege escalation

https://portswigger.net/web-security/sql-injection
